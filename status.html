<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>í˜„í™©ì¡°ì‚¬</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@300;400;500;700&display=swap" rel="stylesheet">
<style>
:root {
  --gold: #8B7355;
  --gold-light: #B8A088;
  --gold-dark: #6B5740;
  --bg: #FAFAF8;
  --card: #FFFFFF;
  --text: #2D2A26;
  --text-sub: #8C8680;
  --border: #E8E4DF;
  --input-bg: #F7F5F2;
  --input-focus: #FDF8F3;
  --accent: #D4A574;
  --success: #6B8F5E;
  --error: #C75C5C;
}
* { margin: 0; padding: 0; box-sizing: border-box; }
body {
  font-family: 'Noto Sans KR', -apple-system, sans-serif;
  background: var(--bg);
  color: var(--text);
  line-height: 1.6;
  min-height: 100vh;
  -webkit-font-smoothing: antialiased;
}

.header {
  background: linear-gradient(135deg, var(--gold-dark) 0%, var(--gold) 50%, var(--accent) 100%);
  padding: 2.5rem 1.5rem 2rem;
  text-align: center;
  position: relative;
  overflow: hidden;
}
.header::before {
  content: '';
  position: absolute;
  top: -50%; left: -50%;
  width: 200%; height: 200%;
  background: radial-gradient(circle at 30% 70%, rgba(255,255,255,0.08) 0%, transparent 50%);
}
.header-badge {
  display: inline-block;
  background: rgba(255,255,255,0.15);
  backdrop-filter: blur(10px);
  border: 1px solid rgba(255,255,255,0.2);
  border-radius: 2rem;
  padding: 0.35rem 1.2rem;
  font-size: 0.75rem;
  font-weight: 500;
  color: rgba(255,255,255,0.9);
  letter-spacing: 0.1em;
  margin-bottom: 1rem;
}
.header h1 {
  color: #fff;
  font-size: 1.5rem;
  font-weight: 700;
  letter-spacing: -0.02em;
  margin-bottom: 0.4rem;
  position: relative;
}
.header p {
  color: rgba(255,255,255,0.75);
  font-size: 0.85rem;
  font-weight: 300;
  position: relative;
}

.progress-wrap {
  padding: 1rem 1.5rem 0;
  max-width: 480px;
  margin: 0 auto;
}
.progress-bar {
  height: 3px;
  background: var(--border);
  border-radius: 2px;
  overflow: hidden;
}
.progress-fill {
  height: 100%;
  background: var(--gold);
  border-radius: 2px;
  width: 0%;
  transition: width 0.4s ease;
}
.progress-text {
  text-align: right;
  font-size: 0.7rem;
  color: var(--text-sub);
  margin-top: 0.3rem;
}

.container {
  max-width: 480px;
  margin: 0 auto;
  padding: 1rem 1.5rem 2rem;
}

.section {
  background: var(--card);
  border: 1px solid var(--border);
  border-radius: 1rem;
  padding: 1.5rem;
  margin-bottom: 1rem;
  box-shadow: 0 1px 3px rgba(0,0,0,0.03);
}
.section-title {
  display: flex;
  align-items: center;
  gap: 0.6rem;
  font-size: 1rem;
  font-weight: 700;
  color: var(--text);
  margin-bottom: 1.2rem;
  padding-bottom: 0.8rem;
  border-bottom: 1px solid var(--border);
}
.section-num {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 1.6rem;
  height: 1.6rem;
  background: var(--gold);
  color: #fff;
  border-radius: 0.4rem;
  font-size: 0.75rem;
  font-weight: 700;
  flex-shrink: 0;
}

.field {
  margin-bottom: 1rem;
}
.field:last-child {
  margin-bottom: 0;
}
.field label {
  display: block;
  font-size: 0.8rem;
  font-weight: 500;
  color: var(--text);
  margin-bottom: 0.4rem;
}
.required { color: var(--error); }

input, select {
  width: 100%;
  padding: 0.7rem 0.9rem;
  border: 1px solid var(--border);
  border-radius: 0.5rem;
  font-size: 0.9rem;
  font-family: inherit;
  background: var(--input-bg);
  color: var(--text);
  transition: all 0.2s;
  -webkit-appearance: none;
}
input:focus, select:focus {
  outline: none;
  border-color: var(--gold);
  background: var(--input-focus);
  box-shadow: 0 0 0 3px rgba(139,115,85,0.1);
}
input::placeholder {
  color: #C5BFB8;
}
select {
  cursor: pointer;
  background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='8'%3E%3Cpath d='M1 1l5 5 5-5' fill='none' stroke='%238C8680' stroke-width='1.5' stroke-linecap='round'/%3E%3C/svg%3E");
  background-repeat: no-repeat;
  background-position: right 0.8rem center;
  padding-right: 2.5rem;
}

.row {
  display: flex;
  gap: 0.8rem;
}
.row .field {
  flex: 1;
}

.input-unit {
  position: relative;
}
.input-unit input {
  padding-right: 3rem;
  text-align: right;
}
.input-unit .unit {
  position: absolute;
  right: 0.9rem;
  top: 50%;
  transform: translateY(-50%);
  font-size: 0.8rem;
  color: var(--text-sub);
  pointer-events: none;
}

.section-hint {
  font-size: 0.78rem;
  color: var(--text-sub);
  margin-bottom: 1rem;
  line-height: 1.5;
}

.invest-item {
  display: flex;
  align-items: center;
  gap: 0.8rem;
  padding: 0.8rem 0;
  border-bottom: 1px solid var(--border);
}
.invest-item:last-child {
  border-bottom: none;
  padding-bottom: 0;
}
.invest-item .invest-icon {
  width: 2.2rem;
  height: 2.2rem;
  border-radius: 0.5rem;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 1rem;
  flex-shrink: 0;
}
.invest-item .invest-label {
  flex: 1;
  font-size: 0.85rem;
  font-weight: 500;
  color: var(--text);
}
.invest-item .invest-label small {
  display: block;
  font-size: 0.72rem;
  font-weight: 400;
  color: var(--text-sub);
  margin-top: 0.1rem;
}
.invest-item .input-unit {
  width: 9rem;
}
.invest-item .input-unit input {
  font-size: 0.85rem;
  padding: 0.55rem 2.8rem 0.55rem 0.7rem;
}

.icon-overseas { background: #FCEAEA; color: #C75C5C; }
.icon-domestic { background: #E8F0F8; color: #5B8DBE; }
.icon-savings  { background: #EAF5E8; color: #6B8F5E; }
.icon-pension  { background: #F5F0EB; color: #8B7355; }

.error-msg {
  display: none;
  background: #FEF2F2;
  border: 1px solid #FECACA;
  color: var(--error);
  padding: 0.7rem 1rem;
  border-radius: 0.5rem;
  font-size: 0.85rem;
  margin-bottom: 1rem;
}

.submit-btn {
  width: 100%;
  padding: 1rem;
  background: linear-gradient(135deg, var(--gold-dark), var(--gold));
  color: #fff;
  border: none;
  border-radius: 0.7rem;
  font-size: 1rem;
  font-weight: 700;
  font-family: inherit;
  cursor: pointer;
  transition: all 0.2s;
  margin-top: 0.5rem;
  position: relative;
}
.submit-btn:hover {
  transform: translateY(-1px);
  box-shadow: 0 4px 15px rgba(139,115,85,0.3);
}
.submit-btn:disabled {
  opacity: 0.6;
  cursor: not-allowed;
  transform: none;
}
.spinner {
  display: inline-block;
  width: 1rem; height: 1rem;
  border: 2px solid rgba(255,255,255,0.3);
  border-top-color: #fff;
  border-radius: 50%;
  animation: spin 0.6s linear infinite;
  vertical-align: middle;
  margin-right: 0.4rem;
}
@keyframes spin { to { transform: rotate(360deg); } }

.footer-note {
  max-width: 480px;
  margin: 0 auto;
  padding: 0 1.5rem 3rem;
  text-align: center;
  font-size: 0.72rem;
  color: var(--text-sub);
  line-height: 1.6;
}

.done-screen {
  display: none;
  text-align: center;
  padding: 4rem 2rem;
  min-height: 80vh;
  display: none;
  flex-direction: column;
  align-items: center;
  justify-content: center;
}
.done-icon {
  width: 4rem; height: 4rem;
  background: var(--success);
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin: 0 auto 1.5rem;
}
.done-icon svg {
  width: 2rem; height: 2rem;
  fill: none;
  stroke: #fff;
  stroke-width: 2.5;
  stroke-linecap: round;
  stroke-linejoin: round;
}
.done-screen h2 {
  font-size: 1.4rem;
  color: var(--text);
  margin-bottom: 0.8rem;
}
.done-screen p {
  font-size: 0.9rem;
  color: var(--text-sub);
  line-height: 1.7;
}

@media (max-width: 500px) {
  .row { flex-direction: column; gap: 0; }
  .invest-item { flex-wrap: wrap; }
  .invest-item .input-unit { width: 100%; margin-top: 0.3rem; }
}
</style>
</head>
<body>

<div id="formView">
  <div class="header">
    <div class="header-badge">ROYAL TEAM</div>
    <h1>íˆ¬ìí˜„í™© ê°„í¸ì¡°ì‚¬</h1>
    <p>30ì´ˆë©´ ì¶©ë¶„í•©ë‹ˆë‹¤</p>
  </div>

  <div class="progress-wrap">
    <div class="progress-bar"><div class="progress-fill" id="progressFill"></div></div>
    <div class="progress-text" id="progressText">0 / 3</div>
  </div>

  <!-- FC ê²€ìƒ‰ í™”ë©´ -->
  <div id="fcSearchView" class="container">
    <div class="section">
      <div class="section-title"><span class="section-num">âœ¦</span>ë‹´ë‹¹ FC í™•ì¸</div>
      <p style="font-size:0.85rem; color:var(--text-sub); margin-bottom:1rem;">ë‹´ë‹¹ ì¬ë¬´ì„¤ê³„ì‚¬(FC) ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.</p>
      <div class="row">
        <div class="field" style="flex:1;">
          <label>FC ì´ë¦„ <span class="required">*</span></label>
          <div style="display:flex; gap:0.5rem;">
            <input type="text" id="fcNameInput" placeholder="ì´ë¦„ ì…ë ¥" style="flex:1;">
            <button type="button" id="fcSearchBtn" style="padding:0.6rem 1.2rem; background:var(--gold); color:#fff; border:none; border-radius:0.5rem; font-size:0.85rem; font-weight:500; cursor:pointer; white-space:nowrap;">ê²€ìƒ‰</button>
          </div>
        </div>
      </div>
      <div id="fcSearchResult" style="margin-top:1rem; display:none;"></div>
      <div id="fcConfirmed" style="margin-top:1rem; display:none; padding:0.8rem 1rem; background:#F0EDE8; border-radius:0.5rem;">
        <span style="font-size:0.85rem; color:var(--gold-dark); font-weight:500;" id="fcConfirmedText"></span>
        <input type="hidden" id="fcId" value="">
        <input type="hidden" id="fcNameVal" value="">
      </div>
      <button type="button" id="fcNextBtn" disabled style="margin-top:1.5rem; width:100%; padding:0.9rem; background:var(--gold); color:#fff; border:none; border-radius:0.6rem; font-size:0.95rem; font-weight:600; cursor:pointer; opacity:0.4; transition:opacity 0.3s;">ì •ë³´ ì…ë ¥ ì‹œì‘ â†’</button>
    </div>
  </div>

  <form id="mainForm" class="container" autocomplete="off" style="display:none;">

    <div id="errorMsg" class="error-msg"></div>

    <!-- 1. ê¸°ë³¸ ì¸ì ì‚¬í•­ -->
    <div class="section" data-section="1">
      <div class="section-title"><span class="section-num">1</span>ê¸°ë³¸ ì¸ì ì‚¬í•­</div>
      <div class="row">
        <div class="field">
          <label>ì„±ëª… <span class="required">*</span></label>
          <input type="text" name="name" placeholder="í™ê¸¸ë™" required>
        </div>
        <div class="field">
          <label>ìƒë…„ì›”ì¼ <span class="required">*</span></label>
          <input type="text" name="birth" placeholder="1985.03.15" inputmode="numeric">
        </div>
      </div>
      <div class="row">
        <div class="field">
          <label>ì„±ë³„</label>
          <select name="gender">
            <option value="">ì„ íƒ</option>
            <option value="ë‚¨">ë‚¨</option>
            <option value="ì—¬">ì—¬</option>
          </select>
        </div>
        <div class="field">
          <label>ì—°ë½ì²˜</label>
          <input type="tel" name="phone" placeholder="010-1234-5678">
        </div>
      </div>
      <div class="field">
        <label>ì§ì—… / ì§ì¥</label>
        <input type="text" name="job" placeholder="ì‚¼ì„±ì „ì ê³¼ì¥">
      </div>
    </div>

    <!-- 2. ì›” ìˆ˜ì… -->
    <div class="section" data-section="2">
      <div class="section-title"><span class="section-num">2</span>ì›” ìˆ˜ì…</div>
      <div class="row">
        <div class="field">
          <label>ì§ì¥ ìˆ˜ì… (ì„¸ì „)</label>
          <div class="input-unit">
            <input type="text" name="income_salary" placeholder="500" inputmode="numeric">
            <span class="unit">ë§Œì›</span>
          </div>
        </div>
        <div class="field">
          <label>ë¶€ìˆ˜ì… (ë¶€ì—…/ê¸°íƒ€)</label>
          <div class="input-unit">
            <input type="text" name="income_side" placeholder="0" inputmode="numeric">
            <span class="unit">ë§Œì›</span>
          </div>
        </div>
      </div>
    </div>

    <!-- 3. ì €ì¶•Â·íˆ¬ì í˜„í™© -->
    <div class="section" data-section="3">
      <div class="section-title"><span class="section-num">3</span>ì €ì¶• Â· íˆ¬ì í˜„í™© (ì›”)</div>
      <div class="section-hint">ë§¤ì›” íˆ¬ìÂ·ì €ì¶•í•˜ê³  ìˆëŠ” ê¸ˆì•¡ì„ ëŒ€ëµì ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”.</div>

      <div class="invest-item">
        <div class="invest-icon icon-overseas">ğŸŒ</div>
        <div class="invest-label">í•´ì™¸ ì£¼ì‹/ETF/í€ë“œ<small>ë¯¸êµ­ì£¼ì‹, S&P500, í•´ì™¸í€ë“œ ë“±</small></div>
        <div class="input-unit">
          <input type="text" name="invest_overseas" placeholder="0" inputmode="numeric">
          <span class="unit">ë§Œì›</span>
        </div>
      </div>

      <div class="invest-item">
        <div class="invest-icon icon-domestic">ğŸ‡°ğŸ‡·</div>
        <div class="invest-label">êµ­ë‚´ ì£¼ì‹/ETF/í€ë“œ<small>ì½”ìŠ¤í”¼, ì½”ìŠ¤ë‹¥, êµ­ë‚´í€ë“œ ë“±</small></div>
        <div class="input-unit">
          <input type="text" name="invest_domestic" placeholder="0" inputmode="numeric">
          <span class="unit">ë§Œì›</span>
        </div>
      </div>

      <div class="invest-item">
        <div class="invest-icon icon-savings">ğŸ¦</div>
        <div class="invest-label">ì˜ˆÂ·ì ê¸ˆ<small>ì •ê¸°ì˜ˆê¸ˆ, ì ê¸ˆ, CMA ë“±</small></div>
        <div class="input-unit">
          <input type="text" name="invest_savings" placeholder="0" inputmode="numeric">
          <span class="unit">ë§Œì›</span>
        </div>
      </div>

      <div class="invest-item">
        <div class="invest-icon icon-pension">ğŸ›¡ï¸</div>
        <div class="invest-label">ì—°ê¸ˆì €ì¶•/IRP<small>ì—°ê¸ˆì €ì¶•í€ë“œ, IRP, DCí˜• ë“±</small></div>
        <div class="input-unit">
          <input type="text" name="invest_pension" placeholder="0" inputmode="numeric">
          <span class="unit">ë§Œì›</span>
        </div>
      </div>
    </div>

    <button type="submit" class="submit-btn" id="submitBtn">ì œì¶œí•˜ê¸°</button>
  </form>

  <div class="footer-note">
    <p>â€» ì •í™•í•œ ê¸ˆì•¡ì´ ì•„ë‹ˆì–´ë„ ê´œì°®ìŠµë‹ˆë‹¤.<br>ëŒ€ëµì ì¸ ê·œëª¨ë§Œ ì•Œë ¤ì£¼ì…”ë„ ì¶©ë¶„í•©ë‹ˆë‹¤.</p>
    <p style="margin-top:0.5rem;">â€» ì‘ì„±í•´ì£¼ì‹  ì •ë³´ëŠ” ì¬ë¬´ìƒë‹´ ëª©ì ìœ¼ë¡œë§Œ í™œìš©ë˜ë©°,<br>ì™¸ë¶€ì— ê³µìœ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.</p>
  </div>
</div>

<!-- ì™„ë£Œ í™”ë©´ -->
<div id="doneView" class="done-screen">
  <div class="done-icon">
    <svg viewBox="0 0 24 24"><polyline points="20 6 9 17 4 12"/></svg>
  </div>
  <h2>ì œì¶œ ì™„ë£Œ!</h2>
  <p>ì†Œì¤‘í•œ ì •ë³´ ê°ì‚¬í•©ë‹ˆë‹¤.<br>ë§ì¶¤ íˆ¬ì ë¶„ì„ì„ ì¤€ë¹„í•˜ì—¬<br>ë¹ ë¥´ê²Œ ì—°ë½ë“œë¦¬ê² ìŠµë‹ˆë‹¤.</p>
</div>

<script>
// ============================================================
// Google Apps Script URL
// ============================================================
const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbwsgKgSGktuF9sK0GSQQU0MPW8bGGgFPAckPtDxzlPS6rzE_yoxQYBncyZ2LFDOir_pHw/exec';

// ============================================================
// FC ê²€ìƒ‰
// ============================================================
const fcNameInput = document.getElementById('fcNameInput');
const fcSearchBtn = document.getElementById('fcSearchBtn');
const fcSearchResult = document.getElementById('fcSearchResult');
const fcConfirmed = document.getElementById('fcConfirmed');
const fcNextBtn = document.getElementById('fcNextBtn');
let selectedFC = null;

fcSearchBtn.addEventListener('click', searchFC);
fcNameInput.addEventListener('keydown', e => { if (e.key === 'Enter') { e.preventDefault(); searchFC(); } });

async function searchFC() {
  const name = fcNameInput.value.trim();
  if (!name) { alert('ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.'); fcNameInput.focus(); return; }

  fcSearchBtn.disabled = true;
  fcSearchBtn.textContent = 'ê²€ìƒ‰ ì¤‘...';
  fcSearchResult.style.display = 'none';
  fcConfirmed.style.display = 'none';
  selectedFC = null;
  fcNextBtn.disabled = true;
  fcNextBtn.style.opacity = '0.4';

  try {
    const url = SCRIPT_URL + '?action=searchFC&name=' + encodeURIComponent(name);
    const res = await fetch(url);
    const json = await res.json();

    if (json.status === 'ok' && json.results && json.results.length > 0) {
      if (json.results.length === 1) {
        confirmFC(json.results[0]);
      } else {
        let html = '<p style="font-size:0.85rem; color:var(--text); margin-bottom:0.5rem;">ê²€ìƒ‰ ê²°ê³¼ ' + json.results.length + 'ëª…:</p>';
        json.results.forEach(fc => {
          html += '<button type="button" class="fc-pick-btn" onclick=\'confirmFC(' + JSON.stringify(fc).replace(/'/g,"&#39;") + ')\''
            + ' style="display:block; width:100%; text-align:left; padding:0.7rem 1rem; margin-bottom:0.4rem; background:var(--input-bg); border:1px solid var(--border); border-radius:0.5rem; cursor:pointer; font-size:0.85rem;">'
            + fc.name + ' <span style="color:var(--text-sub);">(' + fc.branch + ')</span></button>';
        });
        fcSearchResult.innerHTML = html;
        fcSearchResult.style.display = 'block';
      }
    } else {
      fcSearchResult.innerHTML = '<p style="color:var(--error); font-size:0.85rem;">í•´ë‹¹ ì´ë¦„ì˜ FCë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>';
      fcSearchResult.style.display = 'block';
    }
  } catch (err) {
    fcSearchResult.innerHTML = '<p style="color:var(--error); font-size:0.85rem;">ê²€ìƒ‰ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.</p>';
    fcSearchResult.style.display = 'block';
  }
  fcSearchBtn.disabled = false;
  fcSearchBtn.textContent = 'ê²€ìƒ‰';
}

function confirmFC(fc) {
  selectedFC = fc;
  fcSearchResult.style.display = 'none';
  fcConfirmed.style.display = 'block';
  document.getElementById('fcConfirmedText').textContent = 'âœ“ ' + fc.name + ' (' + fc.branch + ')';
  document.getElementById('fcId').value = fc.id;
  document.getElementById('fcNameVal').value = fc.name;
  fcNextBtn.disabled = false;
  fcNextBtn.style.opacity = '1';
}

fcNextBtn.addEventListener('click', () => {
  if (!selectedFC) return;
  document.getElementById('fcSearchView').style.display = 'none';
  document.getElementById('mainForm').style.display = 'block';
});

// ============================================================
// ì§„í–‰ë¥ 
// ============================================================
const form = document.getElementById('mainForm');
const sections = form.querySelectorAll('.section');
const progressFill = document.getElementById('progressFill');
const progressText = document.getElementById('progressText');
const totalSections = sections.length;

function updateProgress() {
  let filled = 0;
  sections.forEach(sec => {
    const inputs = sec.querySelectorAll('input, select');
    let hasFilled = false;
    inputs.forEach(inp => { if (inp.value.trim()) hasFilled = true; });
    if (hasFilled) filled++;
  });
  const pct = Math.round((filled / totalSections) * 100);
  progressFill.style.width = pct + '%';
  progressText.textContent = filled + ' / ' + totalSections;
}
form.addEventListener('input', updateProgress);

// ============================================================
// ìˆ«ì ìë™ ì½¤ë§ˆ
// ============================================================
document.querySelectorAll('.input-unit input').forEach(input => {
  input.addEventListener('input', function() {
    let v = this.value.replace(/[^0-9]/g, '');
    if (v) this.value = Number(v).toLocaleString();
  });
});

// ============================================================
// ì „í™”ë²ˆí˜¸ ìë™ í•˜ì´í”ˆ
// ============================================================
const phoneInput = form.querySelector('[name="phone"]');
if (phoneInput) {
  phoneInput.addEventListener('input', function() {
    let v = this.value.replace(/[^0-9]/g, '');
    if (v.length > 3 && v.length <= 7) v = v.slice(0,3) + '-' + v.slice(3);
    else if (v.length > 7) v = v.slice(0,3) + '-' + v.slice(3,7) + '-' + v.slice(7,11);
    this.value = v;
  });
}

// ============================================================
// ìƒë…„ì›”ì¼ ìë™ ì 
// ============================================================
const birthInput = form.querySelector('[name="birth"]');
if (birthInput) {
  birthInput.addEventListener('input', function() {
    let v = this.value.replace(/[^0-9]/g, '');
    if (v.length > 4 && v.length <= 6) v = v.slice(0,4) + '.' + v.slice(4);
    else if (v.length > 6) v = v.slice(0,4) + '.' + v.slice(4,6) + '.' + v.slice(6,8);
    this.value = v;
  });
}

// ============================================================
// ì œì¶œ
// ============================================================
form.addEventListener('submit', async function(e) {
  e.preventDefault();

  const errorMsg = document.getElementById('errorMsg');
  errorMsg.style.display = 'none';

  const name = form.querySelector('[name="name"]').value.trim();
  if (!name) {
    errorMsg.textContent = 'ì„±ëª…ì„ ì…ë ¥í•´ì£¼ì„¸ìš”.';
    errorMsg.style.display = 'block';
    form.querySelector('[name="name"]').focus();
    return;
  }

  const btn = document.getElementById('submitBtn');
  btn.disabled = true;
  btn.innerHTML = '<span class="spinner"></span>ì œì¶œ ì¤‘...';

  const data = {};
  new FormData(form).forEach((v, k) => {
    data[k] = v.replace(/,/g, '');
  });
  data.timestamp = new Date().toLocaleString('ko-KR');
  data.fc_id = document.getElementById('fcId').value;
  data.fc_name = document.getElementById('fcNameVal').value;
  data.form_type = 'í˜„í™©ì¡°ì‚¬';

  try {
    if (!SCRIPT_URL) {
      console.log('ì œì¶œ ë°ì´í„°:', data);
      alert('í…ŒìŠ¤íŠ¸ ëª¨ë“œ: SCRIPT_URLì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤.');
      btn.disabled = false;
      btn.innerHTML = 'ì œì¶œí•˜ê¸°';
      return;
    }

    await fetch(SCRIPT_URL, {
      method: 'POST',
      mode: 'no-cors',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify(data)
    });

    document.getElementById('formView').style.display = 'none';
    document.getElementById('doneView').style.display = 'flex';
    window.scrollTo(0, 0);

  } catch (err) {
    errorMsg.textContent = 'ì „ì†¡ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.';
    errorMsg.style.display = 'block';
    btn.disabled = false;
    btn.innerHTML = 'ì œì¶œí•˜ê¸°';
  }
});
</script>
</body>
</html>
